一、选题的目的、意义（理论、现实）和国内外研究概况

（一）选题的目的和意义

  当今信息社会中，即时通讯应用已成为人们日常交流的重要工具。然而，传统的即时通讯系统普遍采用中心化服务器架构，存在以下问题：

1. 单点故障风险：中心服务器故障将导致整个系统瘫痪，用户无法进行通信
2. 隐私安全隐患：用户数据集中存储，易受攻击、监控和泄露
3. 扩展性受限：服务器容量限制了系统的用户规模和性能表现
4. 数据主权问题：用户数据由服务提供商控制，用户对自身数据缺乏控制权

本课题旨在设计并实现一个真正去中心化的端到端加密聊天系统，解决传统中心化架构的固有缺陷。主要目的包括：

1. 通过 NATS Routes 集群实现完全去中心化的网络架构，消除单点故障，提高系统可靠性
2. 采用 NaCl Box 和 AES-256-GCM 等军用级加密算法，保护用户通信隐私和数据安全
3. 实现 本地 SQLite 数据库持久化存储，支持完全动态链式组网
4. 通过 Wails v2 框架实现跨平台桌面应用，支持 Windows/macOS/Linux 多个操作系统

（二）国内外研究概况

  在分布式网络通信领域，已有许多相关研究。NATS 是一个高性能、低延迟的云原生消息传递系统，被广泛应用于分布式系统通信。NATS 官方文档详细介绍了其 Routes 集群机制，支持节点间对等通信和自动容错。

在去中心化通讯系统方面，有诸多研究和实践案例。分布式系统研究者通过多种架构模式（如发布-订阅、事件驱动等）实现了去中心化的消息传递。许多点对点（P2P）通讯系统采用分布式哈希表（DHT）实现节点发现，确保网络的高可用性。

在端到端加密技术方面，学术界已有成熟的理论基础。Signal Protocol 等成熟的加密协议被广泛应用于主流通讯应用。NaCl/libsodium 库提供了经过充分验证的密码学原语（X25519、XSalsa20-Poly1305），具有高度的安全性和可靠性。

在跨平台应用开发方面，Electron、React Native 等框架已被广泛应用。Wails 框架作为一个新兴的 Go + Web 技术栈方案，具有更小的应用体积和更低的内存占用，正在获得关注。

综合现有研究，本课题将 NATS 分布式消息系统、NaCl 端到端加密、JetStream 持久化存储和 Wails 跨平台框架有机结合，形成一个完整的去中心化加密聊天系统解决方案。


二、本课题的理论依据、研究内容和研究方法、步骤及进度安排

（一）本课题的理论依据

1. 分布式系统理论
  基于 NATS Routes 集群实现的去中心化架构采用分布式系统的经典设计理论。通过节点间对等通信和自动发现机制，确保系统的高可用性和容错能力。

2. 密码学理论
  NaCl Box 加密算法基于 Elliptic Curve Diffie-Hellman (ECDH) 密钥交换和 XSalsa20-Poly1305 对称加密，提供了 128 位的认证加密安全强度。AES-256-GCM 提供了 256 位的对称加密强度，符合 FIPS 140-2 政府级安全标准。

3. 消息队列理论
  NATS 的发布-订阅模式基于消息队列的经典理论，通过主题（Subject）路由和消息转发实现高效的消息传递。本地 SQLite 存储实现了分布式键值存储的持久化和容错机制。

（二）研究内容

为实现一个完整的去中心化加密聊天系统，本设计需实现以下核心内容：

1. 用户身份管理
   - 实现用户唯一标识和昵称设置
   - 支持 Curve25519 公私钥对生成（32 字节密钥长度）
   - 用户配置本地持久化存储

2. 加密通信功能
   - 实现私聊端到端加密（NaCl Box 算法：X25519 密钥交换 + XSalsa20-Poly1305）
   - 实现群聊对称加密（AES-256-GCM，256 位密钥）
   - 支持好友公钥和群组密钥管理

3. 消息收发功能
   - 支持实时消息发送和接收
   - 支持私聊和群聊两种模式
   - 消息加密传输和正确解密显示

4. 去中心化网络
   - 基于 NATS Routes 集群实现节点对等通信
   - 支持至少 2 个节点互联通信
   - 节点间消息正确路由和传递
   - 实现种子节点连接机制

5. 用户界面
   - 提供基本的聊天界面
   - 显示会话列表和消息记录
   - 提供密钥管理和设置功能

（三）研究方法

1. 理论研究
   - 深入学习 NATS Routes 的工作机制和链式动态加入原理
   - 研究 NaCl 和 AES-GCM 等加密算法的实现
   - 学习分布式系统的设计模式和容错机制

2. 系统设计
   - 设计整体系统架构（前后端分层、模块划分）
   - 设计 NATS 消息主题结构：dchat.dm.{cid}.msg（私聊）、dchat.grp.{gid}.msg（群聊）
   - 设计密钥管理流程和加密通信协议

3. 代码实现
   - 使用 Go 语言实现 NATS 客户端和聊天服务
   - 使用 Go crypto 库实现加密解密功能
   - 使用 React 和 TypeScript 开发前端用户界面
   - 使用 Wails v2 框架集成前后端

4. 测试与验证
   - 进行单元测试验证加密算法正确性
   - 进行集成测试验证多节点通信
   - 在多个操作系统平台进行功能测试

（四）步骤及进度安排

第一阶段：基础框架搭建和加密通信实现（4-5 周）
  1. 开发环境配置和项目结构搭建
     - 配置 Go 1.21+ 和 Node.js 开发环境
     - 搭建 Wails v2 项目框架
     - 集成 NATS Server 和 JetStream KV
  2. 实现用户身份和密钥管理
     - 实现用户配置管理模块
     - 实现 Curve25519 密钥对生成
     - 实现 JetStream KV 密钥存储
  3. 实现端到端加密通信
     - 实现 NaCl Box 加密解密（私聊）
     - 实现 AES-256-GCM 加密解密（群聊）
     - 实现消息主题订阅和发布

第二阶段：去中心化网络和功能完善（4-5 周）
  1. 配置 NATS Routes 集群
     - 配置客户端端口（4222）和集群端口（6222）
     - 实现种子节点连接机制
     - 测试多节点消息路由
  2. 实现聊天功能
     - 实现私聊发送和接收
     - 实现群聊发送和接收
     - 实现消息历史显示
  3. 开发用户界面
     - 开发聊天界面和会话列表
     - 实现密钥管理界面
     - 实现用户设置功能

第三阶段：测试、优化和部署（3 周）
  1. 功能测试和调试
     - 单节点基本功能测试
     - 多节点通信测试
     - 加密功能验证
  2. 跨平台编译和测试
     - Windows 平台测试
     - Linux 平台测试
     - macOS 平台兼容性检查
  3. 性能优化和文档编写
     - 优化启动速度和消息延迟
     - 编写 README 和技术文档
     - 准备答辩材料


三、本课题的重点、难点，预期结果和成果形式

（一）本课题的重点

1. 去中心化网络架构设计
   重点是理解 NATS Routes 集群的工作原理，实现节点间对等通信和自动发现机制。

2. 端到端加密通信实现
   重点是正确实现 NaCl Box 和 AES-256-GCM 加密算法，保证消息的安全性。

3. 密钥管理和持久化
   重点是设计合理的密钥生成、存储和交换机制，利用 JetStream KV 实现持久化。

4. 跨平台应用开发
   重点是掌握 Wails v2 框架，实现 Go 后端与 React 前端的无缝集成。

（二）本课题的难点

1. SQLite 密钥存储和跨节点访问问题
   由于采用本地 SQLite 存储，密钥不跨节点共享。需要设计合理的密钥分发和管理机制，确保用户能在不同节点访问自己的密钥。

2. 密钥安全性和易用性的平衡
   需要在保证密钥安全（私钥文件权限 0600，SQLite 数据库加密）的同时，提供友好的用户界面和操作流程。

3. 加密性能优化
   需要在保证加密强度的前提下，将消息延迟控制在可接受范围内（< 100ms），优化 SQLite 查询性能。

4. 前后端类型安全集成
   需要通过 Wails 框架实现 TypeScript 和 Go 的类型安全绑定，处理异步调用、数据库查询和错误处理。

（三）预期结果

1. 基本功能实现
   - 用户能够创建身份、生成密钥、设置昵称
   - 支持私聊和群聊的端到端加密通信
   - 至少 2 个节点能够成功组网并通信
   - 消息能够正确加密传输和解密显示

2. 性能指标
   - 应用启动时间 < 5 秒
   - 消息发送延迟 < 100 毫秒（局域网）
   - 支持至少 10 个节点同时在线

3. 安全性
   - 私聊消息实现端到端加密
   - 群聊消息实现对称加密
   - 密钥持久化和恢复正常工作

4. 跨平台兼容性
   - 在 Windows 和 Linux 平台编译成功
   - 应用在目标平台正常运行
   - 基本功能测试通过

（四）成果形式

1. 软件成果
   - 可执行的去中心化聊天应用程序（Windows/Linux）
   - 完整的项目源代码
   - 配置文件和使用示例

2. 文档成果
   - 系统设计文档（INTERFACE_DOCS.md）
   - 用户使用手册（README.md）
   - 测试报告和故障排除指南
   - API 文档和代码注释

3. 代码成果
   - 后端 Go 代码（聊天服务、NATS 客户端、加密模块、配置管理）
   - 前端 React 代码（聊天界面、密钥管理、用户设置）

4. 演示成果
   - 毕业答辩 PPT
   - 应用功能演示
   - 去中心化网络特性演示（多节点通信、节点容错）
